import numpy as np
from scipy.linalg import hadamard

             #0  1  2  3  4  12 13 14 23 24 34 123 124 134 234 1234
a = np.array([0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0,  0,  0,  1,  0])

equation_system = np.linalg.inv(np.array([
        #0  1  2  3  4  12 13 14 23 24 34 123 124 134 234 1234
        [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0,  0,  0,  0,  0],
        [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,  0,  0,  0,  0],
        [1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0,  0,  0,  0,  0],
        [1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0,  0,  0,  1,  0],
        [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0,  0,  1,  0,  0],
        [1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0,  0,  0,  0,  0],
        [1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0,  1,  0,  0,  0],
        [1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1,  0,  0,  0,  0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  1,  1,  1,  1],
]))

f = np.linalg.solve(equation_system, a) % 2

print("Fourier:  ", hadamard(16).dot(f))
print("Hadamard: ", hadamard(16).dot((-1) ** f))
